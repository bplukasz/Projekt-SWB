C51 COMPILER V9.56.0.0   KLAWIATURAPOKOLUMNACH                                             05/26/2017 21:17:11 PAGE 1   


C51 COMPILER V9.56.0.0, COMPILATION OF MODULE KLAWIATURAPOKOLUMNACH
OBJECT MODULE PLACED IN .\Objects\KlawiaturaPoKolumnach.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE KlawiaturaPoKolumnach.c OMF2 OPTIMIZE(8,SPEED) BROWSE DEBUG PRINT(.\List
                    -ings\KlawiaturaPoKolumnach.lst) TABS(2) OBJECT(.\Objects\KlawiaturaPoKolumnach.obj)

line level    source

   1          #include <REGX52.H>
   2          #define TH0_Value 0x00;
   3          #define TL0_Value 0x00;
   4          
   5          char code wiersze[4] = {0xEF, 0xDF, 0xBF, 0x7F};
   6          char code klawisze[12] = {0xE7, 0xEB, 0xED, 0xD7, 0xDB, 0xDD, 0xB7, 0xBB, 0xBD, 0x77, 0x7B, 0x7D};
   7          char code dekoder[10]={0x3F,0x06,0x5B,0x4F,0x66,0x6D,0x7D,0x07,0x7F,0x6F};
   8          char code slimakTab[19]={0x01,0x02,0x04, 0x08, 0x08, 0x10, 0x20, 0x01, 0x01, 0x02, 0x40, 0x40, 0x20, 0x01,
             - 0x01, 0x02, 0x40, 0x20, 0x01 };
   9          
  10          
  11          char Lewy;
  12          char Prawy;
  13          char FlagaEkranu;
  14          char counterSlimaka;
  15          
  16          void ISR_INT0(void) interrupt 0{
  17   1        Prawy++;
  18   1        if(Prawy==10){
  19   2          Prawy=0;
  20   2          Lewy++;
  21   2        }
  22   1        if(Prawy==10)Prawy=0;
  23   1      }
  24          
  25          void ISR_INT1(void) interrupt 2{
  26   1        Prawy--;
  27   1        if(Prawy==-1){
  28   2          Prawy=9;
  29   2          Lewy--;
  30   2        }
  31   1        if(Lewy==-1)Lewy=9;
  32   1      }
  33          
  34          void zmienEkran(void){
  35   1        if(P3_0==0){
  36   2          P3_0=1;
  37   2          P3_1=0;
  38   2        }
  39   1        else{
  40   2          P3_0=0;
  41   2          P3_1=1;
  42   2        }
  43   1      }
  44          
  45          void slimak(void) interrupt 1{
  46   1        P2=0x00;
  47   1        if(counterSlimaka==4 || counterSlimaka==8 || counterSlimaka==12 || counterSlimaka==15)zmienEkran();
  48   1        P2=slimakTab[counterSlimaka];
  49   1        counterSlimaka++;
  50   1        if(counterSlimaka==19)counterSlimaka=0;
  51   1      }
  52          
  53          
C51 COMPILER V9.56.0.0   KLAWIATURAPOKOLUMNACH                                             05/26/2017 21:17:11 PAGE 2   

  54          
  55          void ISR_Timer0(void){
  56   1        P2=0x00;
  57   1        TR0=0;
  58   1        if(FlagaEkranu==0){
  59   2          P2=dekoder[Prawy];
  60   2          P3_0=1;
  61   2          P3_1=0;
  62   2          FlagaEkranu=1;
  63   2        }
  64   1        else{
  65   2          P2=dekoder[Lewy];
  66   2          P3_0=0;
  67   2          P3_1=1;
  68   2          FlagaEkranu=0;
  69   2        }
  70   1        TH0 = TH0_Value;
  71   1        TL0 = TL0_Value;
  72   1        TR0=1;
  73   1      }
  74          
  75          void init(void){
  76   1        Lewy=0;
  77   1        Prawy=0;
  78   1        P2=0x00;
  79   1        P3_0=1;
  80   1        P3_1=0;
  81   1        FlagaEkranu=0;
  82   1        counterSlimaka=0;
  83   1        EX0=1;
  84   1        EX1=1;
  85   1        IT0=1;
  86   1        IT1=1;
  87   1        TMOD=0x01;
  88   1        TH0=TH0_Value;
  89   1        TL0=TL0_Value;
  90   1        ET0=1;
  91   1        EA=1;
  92   1        TR0=1;
  93   1      }
  94          
  95          void main(void){
  96   1        char i = 0;
  97   1        char j = 0;
  98   1        char k =0;
  99   1        char val = 0;
 100   1        int flaga = 0;
 101   1        char nacisniety = 0x00;
 102   1        char nacisniety1 = 0x00;
 103   1        char nacisniety2 = 0x00;
 104   1        init();
 105   1        while(1){
 106   2          if(i==4)i=0;
 107   2          if(j==12)j=0;
 108   2          P1 = wiersze[i++];
 109   2          val = P1;
 110   2          if(val != wiersze[i-1]){
 111   3            for(k=0;k<3;k++){
 112   4              if(val == klawisze[j++]){
 113   5                while(P1==klawisze[j-1]);
 114   5                nacisniety=j;
 115   5                flaga = 1;
C51 COMPILER V9.56.0.0   KLAWIATURAPOKOLUMNACH                                             05/26/2017 21:17:11 PAGE 3   

 116   5              }
 117   4            }
 118   3          }
 119   2          else j+=3;
 120   2          if(flaga==1){
 121   3            flaga  = 0;
 122   3            if(nacisniety == 10){
 123   4              Prawy=nacisniety1;
 124   4              Lewy=nacisniety2;
 125   4              nacisniety1 = 0x00;
 126   4              nacisniety2 = 0x00;
 127   4            }
 128   3            else{
 129   4              nacisniety2 = nacisniety1;
 130   4              if(nacisniety==11)nacisniety=0;
 131   4              nacisniety1 = nacisniety;
 132   4            }
 133   3          }
 134   2        }
 135   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    459    ----
   CONSTANT SIZE    =     45    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
